# ========== 场景定义 ==========
scenes:
  # 迷雾森林
  - id: "forest"
    name: "迷雾森林"
    description: |
      你站在一片神秘的森林入口。
      古老的树木高耸入云，雾气在林间缭绕。
      你听到远处传来奇怪的声音。
    choices:
      - text: "进入洞穴探险"
        target: "cave"
        condition: null
      
      - text: "前往村庄"
        target: "village"
        condition: null
      
      - text: "在森林中搜索"
        target: null
        action: |
          ui.show_system("你在森林中发现了一些草药！")
          p = engine.get_player(engine_id)
          player.add_item_to_inventory(p, items.herb_001)
          player.add_gold(p, 10)
          ui.show_loot("草药", 3)
      
      - text: "查看状态"
        target: null
        action: |
          p = engine.get_player(engine_id)
          player.show_player_status(p)
    
    on_enter: |
      ui.show_narration("【迷雾森林】")
    
    on_exit: null

  # 幽暗洞穴
  - id: "cave"
    name: "幽暗洞穴"
    description: |
      一个阴暗潮湿的洞穴。
      水滴从洞顶落下，发出滴答声。
      你感觉到有什么东西在黑暗中注视着你。
    choices:
      - text: "返回森林"
        target: "forest"
      
      - text: "深入洞穴"
        target: null
        action: |
          ui.show_combat("玩家", "攻击", "蝙蝠", "命中！造成 5 点伤害")
          p = engine.get_player(engine_id)
          player.gain_exp(p, 20)
          ui.show_system("你获得了 20 点经验值！")
          # 随机获得物品
          if (random.randint(1, 100) > 70) :

            player.add_item_to_inventory(p, items.sword_001)
            ui.show_loot("生锈的剑", 1)
    
    on_enter: |
      ui.show_narration("【幽暗洞穴】")
      ui.show_system("这里很暗...你点燃了火把。")

  # 宁静村庄
  - id: "village"
    name: "宁静村庄"
    description: |
      一个宁静的小村庄。
      村民们友好地向你打招呼，铁匠铺传来叮叮当当的敲打声。
    choices:
      - text: "返回森林"
        target: "forest"
      
      - text: "与村民交谈"
        target: null
        action: |
          ui.show_dialog("村民", "欢迎来到我们的村庄，旅行者！需要休息吗？")
          p = engine.get_player(engine_id)
          old_hp = player.get_player_hp(p)
          player.heal_player(p, 20)
          new_hp = player.get_player_hp(p)
          ui.show_stat_change("HP", old_hp, new_hp)
      
      - text: "在村庄中探索"
        target: null
        action: |
          ui.show_system("你在村庄中闲逛，发现了5枚金币！")
          p = engine.get_player(engine_id)
          player.add_gold(p, 5)
    
    on_enter: |
      ui.show_narration("【宁静村庄】")
      ui.show_system("村民们向你微笑致意。")
