# 简单冒险游戏示例 - 使用 Python 模块版本
# 这个示例展示了如何使用 hpl_game_framework 的 Python 模块

imports:
  - game_engine
  - player
  - scene
  - game_utils
  - interaction

main: () => {
  # 显示欢迎信息
  game_utils.print_title("简单冒险游戏")
  interaction.show_narration("这是一个使用 Python 模块的 HPL 游戏示例。")
  
  # 获取玩家名称
  player_name = interaction.get_string("请输入你的角色名称: ", false)
  
  # 创建游戏引擎
  engine = game_engine.create_game_engine()
  
  # 初始化游戏
  engine.initialize(player_name)
  
  # 创建场景
  forest = scene.create_scene("forest", "迷雾森林", "你站在一片神秘的森林入口。古老的树木高耸入云，雾气在林间缭绕。你听到远处传来奇怪的声音。")
  cave = scene.create_scene("cave", "幽暗洞穴", "一个阴暗潮湿的洞穴。水滴从洞顶落下，发出滴答声。你感觉到有什么东西在黑暗中注视着你。")
  village = scene.create_scene("village", "宁静村庄", "一个宁静的小村庄。村民们友好地向你打招呼，铁匠铺传来叮叮当当的敲打声。")
  
  # 添加选择项
  forest.create_choice("进入洞穴探险", "cave", null, null)
  forest.create_choice("前往村庄", "village", null, null)
  forest.create_choice("在森林中搜索", null, null, () => {
    interaction.show_system("你在森林中发现了一些草药！")
    engine.game_state.player.inventory.add_gold(10)
    interaction.show_loot("草药", 3)
  })
  
  cave.create_choice("返回森林", "forest", null, null)
  cave.create_choice("深入洞穴", null, null, () => {
    interaction.show_combat("玩家", "攻击", "蝙蝠", "命中！造成 5 点伤害")
    engine.game_state.player.gain_exp(20)
    interaction.show_system("你获得了 20 点经验值！")
  })
  
  village.create_choice("返回森林", "forest", null, null)
  village.create_choice("与村民交谈", null, null, () => {
    interaction.show_dialog("村民", "欢迎来到我们的村庄，旅行者！需要休息吗？")
    engine.game_state.player.heal(20)
    interaction.show_stat_change("HP", engine.game_state.player.hp - 20, engine.game_state.player.hp)
  })
  
  # 注册场景
  engine.register_scene(forest)
  engine.register_scene(cave)
  engine.register_scene(village)
  
  # 设置起始场景
  engine.set_start_scene("forest")
  
  # 添加一些初始物品
  sword = player.create_item("sword_001", "生锈的剑", "一把生锈的铁剑，但还能用", "weapon", 50)
  sword.set_stat("attack", 5)
  engine.game_state.player.inventory.add_item(sword)
  
  potion = player.create_item("potion_001", "生命药水", "恢复 30 点生命值", "consumable", 20)
  engine.game_state.player.inventory.add_item(potion)
  
  # 显示初始状态
  interaction.pause("按回车键开始游戏...")
  engine.game_state.player.show_status()
  
  # 运行游戏
  engine.run()
}
